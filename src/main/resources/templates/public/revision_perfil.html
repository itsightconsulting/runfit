<!DOCTYPE html>
<html lang="en" id="extr-page"
      xmlns:th="http://www.thymeleaf.org"
      th:with="version = ${#servletContext.getAttribute('version')}">
<head>
    <title>Inscripci√≥n de entrenadores | Fitness | Runfit</title>
    <th:block th:insert="html-commons/p/meta :: fg-meta"></th:block>
    <th:block th:insert="html-commons/p/css  :: fg-css"></th:block>
    <link rel="stylesheet" type="text/css" th:href="@{/css/public/cropper.min.css}+'?'+${version}"/>
</head>
<body>
<nav th:replace="html-commons/p/header :: fg-header"></nav>
<div th:replace="html-commons/reu-login :: fg-login"></div>
<div id="wrapper">
    <div class="section banner home">
        <div class="bg-image-x"><img class="banner-home" th:src="@{/img/public/trainers-shadow.jpg}"></div>
    </div>
    <section class="trainers-form">
        <div class="row">
            <div class="container">
                <div class="col-md-5">
                    <div class="avatar-form">
                        <input type="file" id="InpImgPerfil">
                        <div class="avatar-form-content img-container">
                            <img id="FinalImagenRecortada" title="Cambiar foto" onclick="javascript:document.getElementById('InpImgPerfil').click()" th:src="@{/img/public/subir_foto.png}" style="height: 220px;"/>
                            <i rel="tooltip" title="Si desea actualizar la imagen de perfil, clickee sobre la imagen actual üì∏" style="float:right; color: #17a2b8;font-size: 1.5em;" class="fa fa-exclamation-circle"></i>
                        </div>
                    </div>
                </div>
                <div class="col-md-7">
                    <ul class="nav nav-tabs">
                        <li class="active"><a data-toggle="tab" href="#about"><span>ACERCA DE M√ç</span></a></li>
                        <li class="hidden"><a data-toggle="tab" href="#staff"><span>STAFF</span></a></li>
                        <li class="hidden"><a data-toggle="tab" href="#service"><span>SERVICIOS</span></a></li>
                    </ul>
                    <form id="frm_registro">
                    <div class="tab-content">
                        <div class="tab-pane fade active in inpts-1" id="about">
                                <div class="form-group">
                                    <div class="">
                                        <label>NOMBRE COMPLETO<span class="obligatorio">*</span></label>
                                        <input class="form-control" name="NombreFull" id="NombreFull" type="text" disabled="disabled">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="pad-right-middle" id="dvSexo" style="width: 100%">
                                        <label>SEXO<span class="obligatorio">*</span></label>
                                        <ul class="checks">
                                            <li>
                                                <div class="chk-content">Masculino
                                                    <input name="Sexo" data-aka="SEXO" value="1" type="radio"><span class="checkmark"></span>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="chk-content">Femenino
                                                    <input name="Sexo" value="2" data-aka="Seleccionar sexo" type="radio"><span class="checkmark"></span>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="form-group" id="dvEspecialidad">
                                    <div class="">
                                        <label>ESPECIALIDAD<span class="obligatorio">*</span></label>
                                        <input class="form-control" name="Especialidad" id="Especialidad" type="text">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>ELIGE EL DEPORTE O ACTIVIDADES QUE REALIZAS<span class="obligatorio">*</span></label>
                                    <ul id="Disciplina" class="list-description">
                                        <li th:each="d : ${disciplinas}">
                                            <p th:attr="data-disc-id=${#strings.substringBefore(d, ',')}" th:text="${#strings.substringAfter(d, ',')}"></p>
                                        </li>
                                    </ul>
                                </div>
                                <div class="form-group">
                                    <label>ACERCA DE M√ç<span class="obligatorio">*</span></label>
                                    <textarea class="form-control" id="Acerca" name="Acerca"></textarea>
                                </div>
                                <div class="form-group">
                                    <div class="pad-right-middle" style="width:100%;">
                                        <label>IDIOMAS<span class="obligatorio">*</span></label>
                                        <ul class="checks" id="Idiomas">
                                            <li style="margin-right: 22px;">
                                                <div class="chk-content">Espa√±ol
                                                    <input name="Idiomas" value="es" data-aka="IDIOMAS*" type="checkbox" checked="checked"/><span class="checkmark"></span>
                                                </div>
                                            </li>
                                            <li style="margin-right: 22px;">
                                                <div class="chk-content">Ingl√©s
                                                    <input name="Idiomas" value="en" type="checkbox"/><span class="checkmark"></span>
                                                </div>
                                            </li>
                                            <li style="margin-right: 22px;">
                                                <div class="chk-content">Portugu√©s
                                                    <input name="Idiomas" value="pt" type="checkbox"/><span class="checkmark"></span>
                                                </div>
                                            </li>
                                            <li style="margin-right: 22px;">
                                                <div class="chk-content">Franc√©s
                                                    <input name="Idiomas" value="fr" type="checkbox"/><span class="checkmark"></span>
                                                </div>
                                            </li>
                                            <li style="margin-right: 22px;">
                                                <div class="chk-content">Chino
                                                    <input name="Idiomas" value="zh" type="checkbox"/><span class="checkmark"></span>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="form-group" id="Estudios">
                                        <label>ESTUDIOS Y CERTIFICACIONES<span class="obligatorio">*</span></label>
                                        <input class="form-control mg-bt-10 inp-estudio" id="EstudiosCertificaciones" name="EstudiosCertificaciones" type="text" placeholder="Ejem: Licenciado en cultura f√≠sica y deporte"/>
                                        <a href="javascript:void(0);" class="add" onclick="javascript:agregarInputDinamico(this, 20, 'inp-estudio', 90)"><i title="Agregar" class="fa fa-15x fa-plus pull-right"></i></a>
                                    </div>
                                    <div class="form-group">
                                        <label>M√âTODO DE TRABAJO<span class="obligatorio">*</span></label>
                                        <textarea style="overflow: auto" class="form-control" rows="4" type="text" id="MetodoTrabajo" name="MetodoTrabajo"></textarea>
                                    </div>
                                    <div class="form-group" id="ExpLaboral">
                                        <label>EXPERIENCIA LABORAL<span class="obligatorio">*</span></label>
                                        <input class="form-control mg-bt-10 inp-experiencia" id="Experiencias" name="Experiencias" type="text" placeholder="Ejem: Entrenador en AquaLab (2013 ‚Äì hasta la fecha)"/>
                                        <a href="javascript:void(0);" class="add" onclick="javascript:agregarInputDinamico(this, 20, 'inp-experiencia', 90)"><i title="Agregar" class="fa fa-15x fa-plus pull-right"></i></a>
                                    </div>
                                    <div class="form-group" id="Logros">
                                        <label>RESULTADOS OBTENIDOS COMO PROFESIONAL<span class="obligatorio">*</span></label>
                                        <input class="form-control mg-bt-10 inp-resultado" id="Resultados" name="Resultados" type="text" placeholder="Ejem: Campe√≥n en nataci√≥n 100 m libres (2017)"/>
                                        <a href="javascript:void(0);" class="add" onclick="javascript:agregarInputDinamico(this, 20, 'inp-resultado', 90)"><i title="Agregar" class="fa fa-15x fa-plus pull-right"></i></a>
                                    </div>
                                    <div class="form-group" id="dvHorario">
                                        <label>HORARIO LABORAL</label>
                                        <input class="form-control" id="Horario" name="Horario" type="text">
                                    </div>
                                    <div class="form-group" id="Niveles">
                                        <label>SELECCIONA EL NIVEL DE RENDIMIENTO DE LAS PERSONAS QUE ASESORAS<span class="obligatorio">*</span></label>
                                        <ul class="checks">
                                            <li>
                                                <div class="chk-content">Principiante
                                                    <input name="NivelClientes" value="pr" data-aka="Seleccionar nivel de personas a las que entrenas" type="checkbox" checked="checked"/><span class="checkmark"></span>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="chk-content">Intermedio
                                                    <input name="NivelClientes" value="in" type="checkbox"/><span class="checkmark"></span>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="chk-content">Avanzado
                                                    <input name="NivelClientes" value="av" type="checkbox"/><span class="checkmark"></span>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="chk-content">Profesional
                                                    <input name="NivelClientes" value="pf" type="checkbox"/><span class="checkmark"></span>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="form-group hidden" id="lblRangoMapa">
                                        <label>AL AIRE LIBRE / DOMICILIO</label>
                                        <p>Dar click en el mapa para poder elegir el rango de desplazamiento. Tambi√©n puedes escribir la direcci√≥n.</p>
                                        <div class="map" id="map"></div>
                                    </div>
                                    <div class="form-group">
                                        <label>CENTRO DE TRABAJO</label>
                                        <input class="form-control" type="text" id="CentroTrabajo" name="CentroTrabajo" placeholder="AQUALAB - Av. Nicol√°s de Ribera 145, San Isidro">
                                    </div>
                                    <div class="form-group" id="Especialidades">
                                        <label>ESPECIALIDADES QUE DOMINO<span class="obligatorio">*</span></label>
                                        <input class="form-control mg-bt-10 inp-esp-domino" id="EspecDomino" name="EspecDomino" type="text" placeholder="Ejem: Entrenamiento uno a uno"/>
                                        <a href="javascript:void(0);" class="add" onclick="javascript:agregarInputDinamico(this, 20, 'inp-esp-domino', 80)"><i title="Agregar" class="fa fa-15x fa-plus pull-right"></i></a>
                                    </div>
                                    <div class="form-group">
                                        <label>FORMA DE TRABAJO<span class="obligatorio">*</span></label>
                                        <ul class="checks" id="FormasTrabajo">
                                            <li>
                                                <div class="chk-content">Al aire libre
                                                    <input type="checkbox" name="FormaTrabajo" value="ai" data-aka="FORMA DE TRABAJO*"><span class="checkmark"></span>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="chk-content">Personalizado
                                                    <input type="checkbox" name="FormaTrabajo" value="pe"><span class="checkmark"></span>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="chk-content">En grupo
                                                    <input type="checkbox" name="FormaTrabajo" value="eg"><span class="checkmark"></span>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="chk-content">Online
                                                    <input type="checkbox" name="FormaTrabajo" value="on"><span class="checkmark"></span>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="form-group hidden" id="lblGaleriaFotos">
                                        <label>GALER√çA DE FOTOS</label>
                                        <div class="row">
                                            <div class="col-md-12" id="ImgsGaleria">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group rs-trainer">
                                        <label>REDES SOCIALES</label>
                                        <div class="col-xs-1 no_padding"><img th:src="@{/img/public/fb.png} +'?'+ ${version}"></div>
                                        <div class="col-xs-11 no_padding">
                                            <input class="form-control" data-aka="Redes sociales" id="RsFb" name="RsFb" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group rs-trainer">
                                        <div class="col-xs-1 no_padding"><img th:src="@{/img/public/ins.png} +'?'+ ${version}"></div>
                                        <div class="col-xs-11 no_padding">
                                            <input class="form-control" data-aka="Redes sociales" id="RsIn" name="RsIn" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group rs-trainer">
                                        <div class="col-xs-1 no_padding"><img th:src="@{/img/public/youtube.png} +'?'+ ${version}"></div>
                                        <div class="col-xs-11 no_padding">
                                            <input value="" class="form-control" data-aka="Redes sociales" id="RsYo" name="RsYo" type="text">
                                        </div>
                                    </div>
                                </div>

                        </div>
                        <div class="tab-pane fade" id="staff" style="padding: 0px 0px 20px">
                            <form>
                                <h1 class="title-form">ASESORES</h1>
                                <div>
                                    <ul class="staff" id="Staffs">
                                    </ul>
                                </div>
                            </form>
                        </div>
                        <div class="tab-pane fade" id="service">
                            <h4>MIS SERVICIOS</h4>
                            <div>
                                <div class="ver-servicios">
                                </div>
                                <div id="SvcCamposBasicos">
                                    <div class="form-group">
                                        <label>NOMBRE DEL SERVICIO<span class="obligatorio">*</span></label>
                                        <input class="form-control" id="NombreServicio" name="NombreServicio" type="text">
                                    </div>
                                    <div class="form-group">
                                        <label>DESCRIPCI√ìN<span class="obligatorio">*</span></label>
                                        <textarea class="form-control" id="DescripcionServicio" name="DescripcionServicio"></textarea>
                                    </div>
                                    <div class="form-group list-counter" id="MainIncluyeServicios">
                                        <label>QUE INCLUYE<span class="obligatorio">*</span></label>
                                        <li><textarea class="form-control mg-bt-10 inp-svc-incluye" id="PrimerIncluyeServicio" name="PrimerIncluyeServicio" placeholder="Ejem: Tendr√°s cuatro master-class iniciales para mejorar tu t√©cnica de carrera en sesiones grupales."></textarea></li>
                                        <a href="javascript:void(0);" class="add" onclick="javascript:agregarTextareaDinamico(this, 10, 'inp-svc-incluye', 500)">&nbsp;<i title="Agregar" class="fa fa-15x fa-plus pull-right"></i></a>
                                    </div>
                                    <div class="form-group">
                                        <label>INFORMACI√ìN ADICIONAL</label>
                                        <textarea class="form-control" id="ServicioInfAdic" name="ServicioInfAdic" style="height: 56px !important;"></textarea>
                                    </div>
                                    <div id="EnlaceTYC" class="form-group hidden">
                                        <label>T√âRMINOS Y CONDICIONES:
                                            <a href="#"><i rel="tooltip" title="Ver t√©rminos y condiciones" class="fa fa-fw fa-eye" data-target="#modalTYC" data-toggle="modal"></i></a>
                                        </label>
                                    </div>
                                </div>
                                <h4 class="sub-title">TARIFARIO<span class="obligatorio">*</span>
                                    <i class="fa fa-question-circle" rel="tooltip" data-placement="bottom" title="Los tarifarios van asociados a alg√∫n servicio es por ello que antes de agregar un tarifario debe agregar un servicio"></i>
                                    <i rel="tooltip" data-original-title="Mostrar/Ocultar" data-toggle="collapse" data-target="#contentTarifario" class="fa fa-chevron-up fa-plus-cs" style="color: #a8fa00;float:right;"></i>
                                </h4>
                                <div class="row">
                                    <div class="col col-md-12 text-center" id="Tarifarios">
                                    </div>
                                </div>
                                <div class="clase-tarifario collapse in" id="contentTarifario">
                                    <div class="form-group">
                                        <label for="NombreTarifario">NOMBRE<span class="obligatorio">*</span></label>
                                        <input type="text" id="NombreTarifario" name="NombreTarifario" class="form-control">
                                    </div>
                                    <div class="form-group">
                                        <label for="FrecuenciaPaquete">FRECUENCIA<span class="obligatorio">*</span></label>
                                        <select class="form-control full-100 hidden" id="FrecuenciaPaquete">
                                            <option value="Diaria">Diaria</option>
                                            <option value="Interdiaria">Interdiaria</option>
                                            <option value="Semanal">Semanal</option>
                                            <option value="Quincenal">Quincenal</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-xs-7">
                                                <label>CANTIDAD DE PERSONAS</label>
                                            </div>
                                            <div class="col-xs-5 text-right">
                                                <ul class="counter">
                                                    <li class="count">
                                                        <button class="counter-round" type="button" onclick="acumuladorMas('txtCantidadPersonas')"><span class="fa fa-plus"></span></button>
                                                    </li>
                                                    <li class="result">
                                                        <input class="counter-input" id="txtCantidadPersonas" name="txtCantidadPersonas" type="text" value="0" disabled="disabled">
                                                    </li>
                                                    <li class="count">
                                                        <button class="counter-round" type="button" onclick="acumuladorMenos('txtCantidadPersonas')"><span class="fa fa-minus"></span></button>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-7">
                                                <label>CANTIDAD DE MESES</label>
                                            </div>
                                            <div class="col-xs-5 text-right">
                                                <ul class="counter">
                                                    <li class="count">
                                                        <button class="counter-round" type="button" onclick="acumuladorMas('txtCantidadMeses')"><span class="fa fa-plus"></span></button>
                                                    </li>
                                                    <li class="result">
                                                        <input class="counter-input" disabled="disabled" id="txtCantidadMeses" name="txtCantidadMeses" type="text" value="0">
                                                    </li>
                                                    <li class="count">
                                                        <button class="counter-round" type="button" onclick="acumuladorMenos('txtCantidadMeses')"><span class="fa fa-minus"></span></button>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-7">
                                                <label>CANTIDAD DE SESIONES</label>
                                            </div>
                                            <div class="col-xs-5 text-right">
                                                <ul class="counter">
                                                    <li class="count">
                                                        <button class="counter-round" type="button" onclick="acumuladorMas('txtCantidadSesiones')"><span class="fa fa-plus"></span></button>
                                                    </li>
                                                    <li class="result">
                                                        <input class="counter-input" disabled="disabled" id="txtCantidadSesiones" name="txtCantidadSesiones" type="text" value="0">
                                                    </li>
                                                    <li class="count">
                                                        <button class="counter-round" type="button" onclick="acumuladorMenos('txtCantidadSesiones')"><span class="fa fa-minus"></span></button>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-7">
                                                <label>PRECIO TOTAL(S/.)</label>
                                            </div>
                                            <div class="col-xs-5 text-right">
                                                <input id="PrecioPaquete" name="PrecioPaquete" class="price" type="text" value="0.00">
                                            </div>
                                        </div>
                                    </div>
                                <hr>
                                <h4>INFORMACI√ìN DE PAGO<span class="obligatorio">*</span>
                                </h4>
                                <div class="row">
                                    <div class="col col-md-12" id="MediosPagosAgregados" style="padding-bottom:15px">
                                        <a href="javascript:void(0);" class="cc-elegido hidden" data-id="0" style="padding-right: 30px"><img th:src="@{/img/money.png}" style="width: 64px;padding-bottom: 10px"></a>
                                        <a href="javascript:void(0);" class="cc-elegido hidden" data-id="1" style="padding-right: 30px"><img th:src="@{/img/mastercard.png}" style="width: 64px;padding-bottom: 10px"></a>
                                        <a href="javascript:void(0);" class="cc-elegido hidden" data-id="2" style="padding-right: 30px"><img th:src="@{/img/visa.png}" style="width: 64px;padding-bottom: 10px"></a>
                                        <a href="javascript:void(0);" class="cc-elegido hidden" data-id="3" style="padding-right: 30px"><img th:src="@{/img/amex.png}" style="width: 64px;padding-bottom: 10px"></a>
                                        <a href="javascript:void(0);" class="cc-elegido hidden" data-id="4" style="padding-right: 30px"><img th:src="@{/img/diners-club.png}" style="width: 64px;padding-bottom: 10px"></a>
                                        <a href="javascript:void(0);" class="cc-elegido hidden" data-id="5" style="padding-right: 30px"><img th:src="@{/img/discover.png}" style="padding-bottom: 10px"></a>
                                    </div>
                                </div>
                                <div class="collapse in" id="contentInfoPago">
                                    <div class="form-group info-cuenta hidden">
                                        <select class="form-control" name="BancoId" id="BancoId">
                                        </select>
                                    </div>
                                    <div class="form-group info-cuenta hidden">
                                        <input class="form-control" id="TitularCuenta" type="text" placeholder="Titular de la cuenta">
                                    </div>
                                    <div class="form-group info-cuenta hidden">
                                        <select class="form-control" id="TitularTipoDoc">
                                            <option value="DNI">DNI</option>
                                            <option value="CE">CE</option>
                                        </select>
                                    </div>
                                    <div class="form-group info-cuenta hidden">
                                        <input class="form-control" id="TitularNumDoc" type="text" placeholder="N√∫mero de documento de identidad">
                                    </div>
                                    <div class="form-group info-cuenta hidden">
                                        <input class="form-control" id="NumeroCuentaSoles" type="text" placeholder="N√∫mero de cuenta soles">
                                    </div>
                                    <div class="form-group info-cuenta hidden">
                                        <input class="form-control" id="NumeroCuentaDolares" type="text" placeholder="N√∫mero de cuenta d√≥lares">
                                    </div>
                                    <div class="form-group info-cuenta hidden">
                                        <input class="form-control" id="InterbancarioSoles" type="text" placeholder="N√∫mero de c√≥digo interbancario soles">
                                    </div>
                                    <div class="form-group info-cuenta hidden">
                                        <input class="form-control" id="InterbancarioDolares" type="text" placeholder="N√∫mero de c√≥digo interbancario d√≥lares">
                                    </div>
                                    <div class="form-group info-tarjetas hidden">
                                        <a href="javascript:void(0);" style="padding-right: 30px"><img data-id="1" class="img-cc cc-elegir" th:src="@{/img/mastercard.png}+'?'+${version}" style="width: 64px;"></a>
                                        <a href="javascript:void(0);" style="padding-right: 30px"><img data-id="2" class="img-cc cc-elegir" th:src="@{/img/visa.png}+'?'+${version}" style="width: 64px;"></a>
                                        <a href="javascript:void(0);" style="padding-right: 30px"><img data-id="3" class="img-cc cc-elegir" th:src="@{/img/amex.png}+'?'+${version}" style="width: 64px;"></a>
                                        <a href="javascript:void(0);" style="padding-right: 30px"><img data-id="4" class="img-cc cc-elegir" th:src="@{/img/diners-club.png}+'?'+${version}" style="width: 64px;"></a>
                                        <a href="javascript:void(0);" style="padding-right: 30px"><img data-id="5" class="img-cc cc-elegir" th:src="@{/img/discover.png}+'?'+${version}"></a>
                                    </div>
                                </div>
                                <hr>
                                <input type="file" id="inpCondServicio" class="hide">
                                <input type="hidden" id="FichaClienteId"/>
                                <div class="form-group hidden" id="divNota">
                                    <label>NOTA
                                        <i class="fa fa-question-circle" rel="tooltip" data-placement="bottom" title="" data-original-title="Nota general sobre cualquier aspecto que desees remarcar y hacerle llegar al usuario"></i>
                                    </label>
                                    <textarea class="form-control" id="Nota" name="Nota"></textarea>
                                </div>
                            </div>
                        </div>

                            </div>
                        </div>
                        <div class="form-group div-actualizacion">
                            <input id="HshTrainerId" type="hidden" th:value="${hshTrainerId}">
                            <button class="btn btn-default btn-black" id="btnGuardar"><i class="fa fa-check"></i>ACTUALIZAR Y ENVIAR</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
</div>
<footer th:replace="html-commons/p/footer :: fg-footer"></footer>
<!-- MODALS -->
<th:block th:insert="public/modals-trainer :: fg-modals-p-trainer"></th:block>
<div class="col-md-6 no-padding-991" id="status" style="display: none">
    <b>Coordenadas:</b> --
    <br class="cb"/><b>Radio:</b> --
</div>
<th:block th:insert="html-commons/p/js :: fg-js"></th:block>
<script th:src="@{/js/g_maps.js}+'?'+${version}"></script>
<script async="" defer="" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAPnQe-1f0b5KmTQXUMED0_n9-Vx3Y4ixc&amp;callback=initMap" type="text/javascript"></script>
<script th:src="@{/js/cropper.min.js}+'?'+${version}" type="text/javascript"></script>
<script th:inline="javascript">
    let $perfil = {};
    const btnGuardar = document.getElementById('btnGuardar');
    const imgPerfil = document.getElementById('ImagePerfil');
    const tabService = document.getElementById('service');
    const inpImgPerfil = document.getElementById('InpImgPerfil');
    const frm = document.getElementById('frm_registro');
    let serviciosSm = [];
    let servicios = [];
    let ccBancarias = [];
    const metodosPago = [];
    let selServicioId = -1;
    let termConSvc = [];
    let accTarifaId = 0;
    let empTrainerId = 0;
    //Cropper
    let cropper = {};
    const actions = document.getElementById('actions');
    const body = document.querySelector('body');

    (function () {
        uploadAndShow(inpImgPerfil, imgPerfil);
        inpImgPerfil.addEventListener('change', changeImgPerfil);
        inpImgPerfil.addEventListener('click', clickImgPerfiL);
        body.addEventListener('click', bodyClickEventListener);
        body.addEventListener('focusout', bodyFocusOutEventListener);
        tabService.addEventListener('click', clickListenerTabService);
        btnGuardar.addEventListener('click', actualizarPerfil);
        init();
    })();

    function bodyClickEventListener(e){
        const input = e.target;
        const clases = input.classList;
        checkBoxAndRadioValidationEventListener(e, input, clases);
    }

    function clickListenerTabService(e) {
        const input = e.target;
        const clases = input.classList;
        if (clases.contains('servicio')) {
            const id = input.getAttribute('data-id');
            selServicioId = Number(id);
            const svcFocus = tabService.querySelector('.svc-focus');
            svcFocus != undefined ? svcFocus.classList.remove('svc-focus') : "";
            clases.add('svc-focus');
            mostrarDetalleServicio(selServicioId);
            const actualEdit = tabService.querySelector('.ver-servicios .edit:not(.hidden)');
            if(actualEdit){
                actualEdit.classList.add('hidden');
            }
            tabService.querySelector(`.ver-servicios .edit[data-id="${selServicioId}"]`).classList.remove('hidden');
        } else if(clases.contains('tarifa-svc')) {
            let padre = {};
            if(input.tagName === "IMG" || input.tagName === "H6"){
                padre = input.parentElement.parentElement;
            } else if(input.tagName === "A"){
                padre = input.parentElement;
            }
            const tarifaId = padre.getAttribute('data-id');
            const svcFocus = tabService.querySelector('.tarifa-svc-pick');
            svcFocus != undefined ? svcFocus.classList.remove('tarifa-svc-pick') : "";
            padre.classList.add('tarifa-svc-pick');
            const abuelo = padre.parentElement;
            abuelo.querySelectorAll('.edit').forEach(e=>e.classList.add('hidden'));
            padre.querySelector('.edit').classList.remove('hidden');
            mostrarDetalleTarifaSvc(Number(tarifaId));
        } else if(clases.contains('edit-svc')){
            const svcId = Number(input.getAttribute('data-id'));
            editarServicio(svcId);
        } else if(clases.contains('edit-tar-svc')){
            const tId = Number(input.getAttribute('data-id'));
            editarTarifa(tId);
        } else if(clases.contains('fa-plus-cs')){
            clases.toggle('fa-chevron-up');
            clases.toggle('fa-chevron-down');
        } else if(clases.contains('info-pago')){
            const parent = input.parentElement;
            const qInput = parent.querySelector('input');
            let nomButton = "Agregar informaci√≥n pago";
            if(qInput.value === "1"){
                tabService.querySelectorAll('.info-cuenta').forEach(e => e.classList.add('hidden'));
                tabService.querySelector('.info-tarjetas').classList.add('hidden');
            }
            if(qInput.value === "2"){
                tabService.querySelector('.info-tarjetas').classList.add('hidden');
                tabService.querySelectorAll('.info-cuenta').forEach(e => e.classList.remove('hidden'));
                nomButton = "Agregar nueva cuenta bancaria";
            }

            if(qInput.value === "3"){
                const exists = metodosPago.some(e=>e.infoPagoId ===3);
                if(exists){
                    nomButton = "Modificar con nueva elecci√≥n";
                }
                tabService.querySelectorAll('.info-cuenta').forEach(e => e.classList.add('hidden'));
                tabService.querySelector('.info-tarjetas').classList.remove('hidden');
            }
            btnNuevaInfoPago.innerText = nomButton;
        } else if(clases.contains('cc-elegir')){
            input.classList.toggle('img-cc');
        } else if(clases.contains('cc-bancaria')){
            const inputBancoId = document.getElementById('ModalCuentaBancoId');
            const ccId = Number(input.getAttribute('data-id'));
            inputBancoId.value = ccId;
            const d = ccBancarias.find(e => e.bancoId === ccId);
            $('#myModalCC').modal('show');
            const dC = document.getElementById('CuentaBancariaUnica');
            dC.querySelector('.cc-nom-banco').textContent = banks.find(b=>b.id==d.bancoId).nombre;
            dC.querySelector('.cc-titular').textContent = d.titular;
            dC.querySelector('.cc-cs').textContent = d.numeroSoles;
            dC.querySelector('.cc-cis').textContent = d.interbancarioSoles;
        } else if(clases.contains('div-fichas')){
            const btn = document.getElementById('btnElegirFicha');
            const fichaName = input.previousElementSibling.textContent.trim();
            btn.innerText = "Ficha seleccionada: "+fichaName;
            btn.click();
            btn.setAttribute("data-ficha-id", fichaName === "Running" ? 1 : 2);
        }
    }

    function init(){
        instanceAllTooltip();
        modalEventos();
        getTrainer();
        constraintsValidation();
        actions.querySelector('.docs-buttons').onclick = function (e) {

            let target = e.target;
            let result;
            let data;

            if (!cropper) {
                return;
            }

            while (target !== this) {
                if (target.getAttribute('data-method')) {
                    break;
                }

                target = target.parentNode;
            }

            if (target === this || target.disabled || target.className.indexOf('disabled') > -1) {
                return;
            }

            data = {
                method: target.getAttribute('data-method'),
                target: target.getAttribute('data-target'),
                option: target.getAttribute('data-option') || undefined,
                secondOption: target.getAttribute('data-second-option') || undefined
            };

            if (data.method) {
                switch (data.method) {
                    case 'getCroppedCanvas':
                        try {
                            data.option = JSON.parse(data.option);
                        } catch (e) {
                            console.log(e.message);
                        }
                        break;
                }

                result = cropper[data.method](data.option, data.secondOption);

                switch (data.method) {
                    case 'getCroppedCanvas':
                        if (result) {
                            $('#FinalImagenRecortada').attr('src', result.toDataURL(inpImgPerfil.files[0].type));
                        }
                        break;
                }
            }
        }
        checkRevisionTrainerDeEmpresa();
    }

    function checkRevisionTrainerDeEmpresa(){
        const url = window.location.href.split("/");
        if(url.find(e=>e==='s')){
            document.querySelectorAll('.rs-trainer').forEach(e => {
                e.classList.add('hidden');
            });
        }
    }

    function modalEventos(){

        $('#myModalCropper').on('shown.bs.modal', ()=>{
            if(typeof cropper.canvas !== 'object'){
                const image = document.getElementById('ImagePerfil');
                cropper = new Cropper(image, {
                    aspectRatio: 1,
                    crop(event) {},
                    zoomOnWheel: false,
                    viewMode: 1,
                    minContainerHeight: image.height > window.innerHeight * 0.8 ? window.innerHeight * 0.8 : image.height
                });
            }
        })
    }

    function clickImgPerfiL(e){
        if(typeof cropper.canvas === 'object'){
            e.preventDefault();
            $('#myModalCropper').modal('show');
        }
    }

    function changeImgPerfil(){
        $('#myModalCropper').modal('show');
    }

    function checkTab(){
        const tabHref = window.location.href.substring(window.location.href.indexOf("#"));
        if(!tabHref.includes('http')){
            const e = document.querySelector(`li a[href="${tabHref}"]`);
            if(e != null){
                e.click();
            }
        }
    }

    function actualizarPerfil(e){
        const val = validationByNumSheet(1);
        const nota = document.querySelector('#Nota');
        if(!val.isValid || !$(nota).valid()){
            if(!$(nota).valid()){
                val.inputs.push(nota);
            }
            smallBoxAlertValidation(val.inputs);
            return;
        }
        e.preventDefault();
        const inpHshId = document.getElementById('HshTrainerId');
        const hshId = inpHshId.value === "" ? $perfil.hshTrainerId : inpHshId.value;
        const d = generateBodyToUpdate();
        d.trainerId = hshId;
        d.servicios = checkServicios();
        d.tipoTrainerId = $perfil.tipoTrainerId;
        deleteSomePropertiesByTipoTraienerId(d);
        if(!d.centroTrabajo){
            delete d.centroTrabajo;
        }
        if(!d.especialidad){
            delete d.especialidad;
        }

        $buttonName = "ACTUALIZAR Y ENVIAR";
        $("#frm_registro :input").prop("disabled", true);
        $.ajax({
            type: 'PUT',
            contentType: 'application/json',
            url: _ctx + 'p/trainer/subsanar/observaciones/perfil',
            dataType: "json",
            data: JSON.stringify(d),
            blockLoading: false,
            bridgeMultipart: true,
            success: function (data, textStatus) {
                if (textStatus == "success") {
                    if(!document.getElementById('FinalImagenRecortada').src.startsWith("https")){
                        uploadFotoPerfil(data);
                    } else{
                        reqSuccess({res: "√âxito, usted actualiz√≥ su ficha correctamente, pronto esta volver√° a ser revisada. Le estaremos notificando los resultados. Gracias"},
                             3600000);
                    }
                    document.querySelector('.div-actualizacion').classList.add('hidden');
                }
            },
            error: function (xhr) {
                exception(xhr);
            },
            complete: function () {
            }
        });
    }

    function deleteSomePropertiesByTipoTraienerId(res){
        if($perfil.tipoTrainerId === TipoTrainer.EMPRESA){
            delete res.estudios;
            delete res.especialidades;
            delete res.experiencias;
        }
    }

    function checkServicios(){
        const svcs = JSON.parse(JSON.stringify(servicios));
        svcs.forEach(e=>{
            e.tarifarios.forEach(t=>{
                delete t.id;
                t.meses = Number(t.meses);
                t.personas = Number(t.personas);
                t.precio = Number(t.precio);
                t.sesiones = Number(t.sesiones);
            })
        });
        return svcs.filter((s, ix)=>{
            return s.descripcion !== serviciosSm[ix].descripcion ||
                   s.incluye !== serviciosSm[ix].incluye ||
                   s.infoAdicional !== serviciosSm[ix].infoAdicional ||
                   s.nombre !== serviciosSm[ix].nombre ||
                   JSON.stringify(s.tarifarios) !== JSON.stringify(serviciosSm[ix].tarifarios)
        })
    }

    function uploadFotoPerfil(d){
        //submit the form here
        const hshId = d.res;
        const rdmUUID = $perfil.nomImgPerfil.substring(0, $perfil.nomImgPerfil.lastIndexOf("."));
        let file = inpImgPerfil;
        if (file.files.length > 0) {
            file = file.files[0];
            const data = new FormData();

            const blobBin = atob($('#FinalImagenRecortada')[0].src.split(',')[1]);
            var array = [];
            for(var i = 0; i < blobBin.length; i++) {
                array.push(blobBin.charCodeAt(i));
            }
            var ff=new Blob([new Uint8Array(array)], {type: file.type});
            data.append("file", ff);
            data.append("fileExtension", ".jpg");

            $.ajax({
                type: 'PUT',
                url: _ctx+'p/trainer/subir/foto/perfil/'+hshId+'/'+rdmUUID,
                data : data,
                contentType: false,
                processData: false,
                dataType: 'json',
                xhr: function() {
                    const myXhr = $.ajaxSettings.xhr();
                    if(myXhr.upload){
                        myXhr.upload.addEventListener('progress', progress, false);
                    }
                    return myXhr;
                },
                success: function (data) {
                    reqSuccess({res: "√âxito, usted actualiz√≥ su ficha correctamente, pronto esta volver√° a ser revisada. Le estaremos notificando los resultados. Gracias"},
                        3600000);
                },
                error: (xhr)=>{
                    exception(xhr);
                },
                complete: ()=> {}
            });
        }
    }

    function getTrainer(){
        const urlArr = window.location.href.split("/");
        const nomPagOrHshId = urlArr[urlArr.length-1];
        let extraPath = urlArr.some(p=>p==="s") ? 'sec/nm/':'sec/';
        $.ajax({
            type: 'GET',
            url: _ctx + 'p/trainer/get/'+extraPath+nomPagOrHshId,
            dataType: 'json',
            blockLoading: false,
            success: function (res) {
                $perfil = res;
                recrearPerfil(res);
                if($perfil.tipoTrainerId !== TipoTrainer.DE_EMPRESA){
                    getServiciosAsync(res.id);
                    document.querySelector('li a[href="#service"]').parentElement.classList.remove('hidden');
                }else{
                    getDisciplinasAsync(res.id);
                }
                checkTab();

            }, error: (xhr) => {
                if(xhr.status == 404){
                    window.location.href = _ctx+"p/recurso-no-encontrado";
                }
                exception(xhr);
            }, complete: () => {
            }
        })
    }

    function getDisciplinasAsync(trainerId){
        $.ajax({
            type: 'GET',
            url: _ctx + 'p/trainer/get/disciplinas/' + trainerId,
            dataType: 'json',
            noOne: true,
            success: function (res) {
                setDisciplinas(res);
            }, error: (xhr) => {
                exception(xhr);
            }, complete: () => {
            }
        })
    }

    function setDisciplinas(arr) {
        const div = document.getElementById('Disciplina');
        const objArr = Array.from(arr).map(e =>{ return {id: e.split(',')[0], nm: e.split(',')[1]}});
        objArr.forEach(e=> {
            div.appendChild(htmlStringToElement(`
              <li>
                  <p data-disc-id="${e.id}">${e.nm}</p>
              </li>
              `));
        })
    }

    function recrearPerfil(t){
        const ttId = t.tipoTrainerId;
        checkTabStaff(t.staffGaleria, t.id, ttId);
        document.querySelector('#FinalImagenRecortada').src = 'https://s3-us-west-2.amazonaws.com/rf-profile-imgs/trainer/'+t.id+"/"+t.nomImgPerfil;
        document.querySelector('#Acerca').value = t.acerca.replace(/\r?\n/g, '\n');
        let idiomas = t.idiomas.split("|");
        const divIdiomas = document.querySelector('#Idiomas');
        idiomas.forEach(i=> divIdiomas.querySelector(`input[value="${i}"]`).checked = true);
        document.querySelector('#MetodoTrabajo').value = t.metodoTrabajo.replace(/\r?\n/g, '\n');
        document.querySelector('#CentroTrabajo').value = t.centroTrabajo;
        const inpRes = document.querySelector('#Resultados');
        const plusButton = inpRes.nextElementSibling;
        const arrResultados = t.resultados.split("|");
        inpRes.value = arrResultados[0];
        arrResultados.slice(1).forEach(e => agregarInputDinamico(plusButton, 20, 'inp-resultado', 90).value = e);
        let niveles = t.niveles.split("|");
        const divNiveles = document.querySelector('#Niveles');
        niveles.forEach(i=> divNiveles.querySelector(`input[value="${i}"]`).checked = true);
        let formasTra = t.formasTrabajo.split("|");
        const divFT = document.querySelector('#FormasTrabajo');
        formasTra.forEach(i=> divFT.querySelector(`input[value="${i}"]`).checked = true);
        if(ttId == TipoTrainer.PARTICULAR || ttId == TipoTrainer.DE_EMPRESA){
            document.querySelector('#NombreFull').value = t.nombreCompleto;
            document.querySelector(`input[name="Sexo"][value="${t.sexo}"]`).checked = true;
            document.querySelector('#Especialidad').value = t.especialidad;
            const inpEst = document.querySelector('#EstudiosCertificaciones');
            const plusInpEst = inpEst.nextElementSibling;
            const arrEstudios= t.estudios.split("|");
            inpEst.value = arrEstudios[0];
            arrEstudios.slice(1).forEach(e => agregarInputDinamico(plusInpEst, 20, 'inp-estudio', 90).value = e);

            const inpExp = document.querySelector('#Experiencias');
            const plusInpExp = inpEst.nextElementSibling;
            const arrExperiencias= t.experiencias.split("|");
            inpExp.value = arrExperiencias[0];
            arrExperiencias.slice(1).forEach(e => agregarInputDinamico(plusInpExp, 20, 'inp-experiencia', 90).value = e);

            const inpEspDom = document.querySelector('#EspecDomino');
            const plusEspDom = inpEspDom.nextElementSibling;
            const arrEspDomino= t.especialidades.split("|");
            inpEspDom.value = arrEspDomino[0];
            arrEspDomino.slice(1).forEach(e => agregarInputDinamico(plusEspDom, 20, 'inp-esp-domino', 80).value = e);
        }else {
            document.querySelector('#NombreFull').value = t.nombreCompleto.substr(0, t.nombreCompleto.indexOf(" xxx"));
            document.getElementById('dvSexo').classList.add('hidden');
            document.querySelectorAll('input[name="Sexo"]').forEach(e=>e.classList.add('ignore'))
            document.getElementById('dvEspecialidad').classList.add('hidden');
            document.querySelector('#Especialidad').classList.add('ignore');
            document.getElementById('Estudios').classList.add('hidden');
            document.getElementById('ExpLaboral').classList.add('hidden');
            document.getElementById('Especialidades').classList.add('hidden');

            document.querySelector('#EstudiosCertificaciones').classList.add('ignore');
            document.querySelector('#Experiencias').classList.add('ignore');
            document.querySelector('#EspecDomino').classList.add('ignore');

        }

        document.querySelector('#Horario').value = t.horario;

        mostrarMediosPago(t.mediosPago, t.cuentas);
        checkMapaAndGaleria(t);
        checkRedesAndNota(t)
    }

    function checkRedesAndNota(t){
        if(t.redes != undefined && t.redes.length > 4){
            const existsFb = t.redes.includes('fb:');
            if(existsFb){
                const r = document.querySelector('#RsFb');
                r.classList.remove('hidden');
                const pre = t.redes.slice(t.redes.indexOf("fb:")+3);
                const f = pre.includes("|") ? pre.slice(0, pre.indexOf("|")) : pre;
                r.value = f;
            }
            const existsIn = t.redes.includes('in:');
            if(existsIn){
                const r = document.querySelector('#RsIn');
                r.classList.remove('hidden');
                const pre = t.redes.slice(t.redes.indexOf("in:")+3);
                const f = pre.includes("|") ? pre.slice(0, pre.indexOf("|")) : pre;
                r.value = f;
            }
            const existsYo = t.redes.includes('yo:');
            if(existsYo){
                const r = document.querySelector('#RsYo');
                r.classList.remove('hidden');
                const pre = t.redes.slice(t.redes.indexOf("yo:")+3);
                const f = pre.includes("|") ? pre.slice(0, pre.indexOf("|")) : pre;
                r.value = f;
            }
        }

        if(t.nota){
            document.getElementById('divNota').classList.remove('hidden');
            document.getElementById('Nota').innerHTML =  t.nota.replace(/\r?\n/g, '<br />');
        }
    }

    function checkTabStaff(staffGaleria, id, ttId){
        if(ttId == 1){
            return;
        }
        if(staffGaleria){
            document.querySelector('.nav-tabs a[href="#staff"]').parentElement.classList.remove('hidden');
            const divStaffs = document.getElementById('Staffs');
            const s = staffGaleria;
            s.split("|").forEach(e=>{
                const imgAndNom = e.split(",");
                divStaffs.appendChild(htmlStringToElement(
                    `<li>
                                    <div class="avatar-form-min">
                                        <img class="img-asesor-emp" src="https://s3-us-west-2.amazonaws.com/rf-profile-imgs/trainer/${imgAndNom[0]}"/>
                                    </div>
                                    <a href="${_ctx}p/trainer/get/revision/s/${imgAndNom.length === 3 ? imgAndNom[2] : ''}" target="_blank"><p>${imgAndNom[1]}</p></a>
                                </li>`
                ))
            })
        }
    }

    function checkMapaAndGaleria(t){
        const baseSrc = 'https://s3-us-west-2.amazonaws.com/rf-profile-imgs/trainer/'+t.id+"/";
        if(t.miniGaleria != null && t.miniGaleria.trim().length>0){
            document.getElementById('lblGaleriaFotos').classList.remove('hidden');
            poblarCarusel(t.miniGaleria.split("|"), 'ImgsGaleria', baseSrc);
        }

        if(t.mapCoordenadas != null && t.mapCoordenadas.trim().length>0){
            document.getElementById('lblRangoMapa').classList.remove('hidden');
            setTimeout(() => {
                const allCord = t.mapCoordenadas.split(",");
                const lat = Number(allCord[0].substr(1));
                const lng = Number(allCord[1].slice(0, -1));
                new google.maps.Circle({
                    strokeColor: '#57ff0e',
                    strokeOpacity: 0.8,
                    strokeWeight: 2,
                    fillColor: '#8ee2ff',
                    fillOpacity: 0.35,
                    map: map,
                    center: {lat: lat, lng: lng},
                    radius: Number(t.mapCircleRadio)
                });
                map.panTo(new google.maps.LatLng(lat, lng));
            }, 1000);
        }
    }

    function reconstruirLista(e, stringArr){
        stringArr.split("|").forEach(v => e.appendChild(htmlStringToElement(`<li><p>${v.trim()}</p></li>`)));
    }

    function reconstruirServicios(svcs){
        if(!svcs) return;
        const resumenServicios = document.querySelector('.ver-servicios');
        svcs.forEach((svc, ix)=>{
            const element = htmlStringToElement(
                `<div class="form-group editar">
                            <a class="edit hidden" data-id="${svc.id}" href="javascript:void(0);" title="Confirmar modificaciones al servicio">
                                <img class="edit-svc" data-id="${svc.id}" src="${_ctx}img/public/edit.png">
                            </a>
                            <label class="servicio" data-id="${svc.id}">${svc.nombre}</label>
                        </div>`);
            resumenServicios.appendChild(element);
        });
    }

    function reconstruirCuentaBanco(cuentas){
        cuentas = JSON.parse(cuentas);
        if(cuentas.length>0){
            const pc = cuentas[0];
            document.getElementById('CuentaBanco').appendChild(htmlStringToElement(`<table class="table">
                                      <thead>
                                      <tr>
                                          <th>MONEDA</th>
                                          <th>CUENTA AHORROS</th>
                                          <th>C√ìDIGO INTERBANCARIO</th>
                                      </tr>
                                      </thead>
                                      <tbody>
                                      <tr>
                                          <td><strong>Soles</strong></td>
                                          <td><strong>${pc.numeroSoles}</strong></td>
                                          <td><strong>${pc.interbancarioSoles}</strong></td>
                                      </tr>
                                      <tr>
                                          <td><strong>D√≥lares</strong></td>
                                          <td><strong>${pc.numeroDolares}</strong></td>
                                          <td><strong>${pc.interbancarioDolares}</strong></td>
                                      </tr>
                                      <tr>
                                          <td><strong>T√≠tular</strong></td>
                                          <td>${pc.titular}</td>
                                          <td></td>
                                      </tr>
                                      <tr>
                                          <td><strong>Banco</strong></td>
                                          <td>${banks.find(e=>e.id==pc.bancoId).nombre}</td>
                                          <td></td>
                                      </tr>
                                      <tr>
                                          <td><strong>${pc.titularTipoDoc}</strong></td>
                                          <td>${pc.titularNumDoc}</td>
                                          <td></td>
                                      </tr>
                                      </tbody>
                                  </table>
          `));
        }
    }

    function reconstruirTarifario(tarifas){
        tarifas.forEach((t,i)=>{t.id = i;
        document.getElementById('Tarifarios').appendChild(htmlStringToElement(`
                            <div class="col-md-2 col-xs-3 mg-bt-10" data-id="${t.id}">
                                <a href="javascript:void(0)" class="tarifa-svc">
                                    <img class="tarifa-svc" src="${_ctx}img/purchase.png" style="width:64px"/>
                                    <h6>${t.nombre}</h6>
                                </a>
                            </div>`))});
    }

    function mostrarDetalleServicio(servicioId){
        const svc = servicios.find(e=>e.id===servicioId);
        document.querySelector('#NombreServicio').value = svc.nombre;
        document.querySelector('#DescripcionServicio').value = svc.descripcion;
        document.querySelector('#ServicioInfAdic').value = svc.infoAdicional;
        setIncluyeDelServicio(svc.incluye);
        setFileTermCond(svc);
        setTarifarios(svc.tarifarios);
    }

    function setFileTermCond(svc){
        if(svc.condicionesServicioRuWeb){
            document.getElementById('EnlaceTYC').classList.remove('hidden');
            const doc = document.createElement('embed');
            doc.type = "application/pdf";
            doc.style = "width: 100%; height: 100%";
            doc.src = 'https://s3-us-west-2.amazonaws.com/rf-profile-imgs/trainer/'+$perfil.id+"/"+svc.condicionesServicioRuWeb;
            document.getElementById('TYC').innerHTML = "";
            document.getElementById('TYC').appendChild(doc);
        } else {
            document.getElementById('EnlaceTYC').classList.add('hidden');
        }
    }

    function setIncluyeDelServicio(incluidos){
        const arrIncluidos = incluidos.split("|");
        const mainIncluidos = document.querySelector('#MainIncluyeServicios');
        if(arrIncluidos < 2){
            mainIncluidos.querySelector('input').value = arrIncluidos[0];
        } else {
            mainIncluidos.innerHTML =
                `<label>QUE INCLUYE<span class="obligatorio">*</span></label>
                     <li><textarea class="form-control mg-bt-10 inp-svc-incluye" id="PrimerIncluyeServicio" name="PrimerIncluyeServicio" maxlength="500" placeholder="Ejem: Tendr√°s cuatro master-class iniciales para mejorar tu t√©cnica de carrera en sesiones grupales."></textarea></li>
                     <a href="javascript:void(0);" class="add" onclick="javascript:agregarTextareaDinamico(this, 10, 'inp-svc-incluye', 500)">&nbsp;<i title="Agregar" class="fa fa-15x fa-plus pull-right"></i></a>`;
            const firstInput = mainIncluidos.querySelector('textarea');
            const btnPlus = mainIncluidos.querySelector('a');

            firstInput.value = arrIncluidos[0];
            arrIncluidos.slice(1).forEach((e,i)=>{
                const ele = agregarTextareaDinamico(btnPlus, 10, 'inp-svc-incluye', 500).firstElementChild;
                ele.name = "inp-svc-incluye"+i;
                ele.value = e;
                $(ele).rules("add",{rangelength: [8, 500]})
            })
        }
    }

    function setTarifarios(tarifarios){
        const dt = document.getElementById('Tarifarios');
        dt.innerHTML = "";
        tarifarios.forEach(t=>{
            dt.appendChild(
                htmlStringToElement(`${putTarifario(t.id, t.nombre)}`));
        })
    }

    function putTarifario(id, nombre){
        setTimeout(()=>{
            $(tabService.querySelector(`#Tarifarios a.edit[data-id="${id}"]`)).tooltip();
        }, 500);
        return `<div class="col-md-3 col-xs-4 mg-bt-10" data-id="${id}">
                        <a href="javascript:void(0)" class="tarifa-svc">
                            <img class="tarifa-svc" src="${_ctx}img/purchase.png" style="width:64px"/>
                            <h6 class="tarifa-svc">${nombre}</h6>
                        </a>
                        <a data-placement="bottom" rel="tooltip" class="edit hidden" data-id="${id}" href="javascript:void(0);" title="Confirmar modificaciones al tarifario seleccionado">
                            <img style="margin: 0px 0px 5px" class="edit-tar-svc" data-id="${id}" src="${_ctx}img/public/edit.png">
                        </a>
                    </div>`
    }

    function mostrarDetalleTarifaSvc(tarifaId){
        const t = servicios.find(v => v.id === selServicioId).tarifarios.find(t=>t.id === tarifaId);
        document.querySelector('#NombreTarifario').value = t.nombre;
        document.querySelector('#txtCantidadPersonas').value = t.personas;
        document.querySelector('#txtCantidadMeses').value = t.meses;
        document.querySelector('#txtCantidadSesiones').value = t.sesiones;
        document.querySelector('#PrecioPaquete').value = parseFloat(t.precio).toFixed(2);
    }

    function editarTarifa(tId){
        const t = getTarifa();
        if(t.valid) {
            const svcAsociado = servicios.find(s=>s.id===selServicioId);
            const tarifarios = svcAsociado.tarifarios;
            const isNomRepeat = tarifarios.filter(e=>e.id!==tId).find(e=>e.nombre === t.nombre);
            if(isNomRepeat){
                $.smallBox({color: "rgb(204, 77, 77)", content: "<i class='fa fa-fw fa-close'></i><em>Nombre del tarifario esta repetido, modificarlo</em>" ,timeout: 3500})
                return;
            }

            let tarifa = tarifarios.find(tar=>tar.id===tId);

            tarifa.nombre = t.nombre;
            tarifa.frecuencia = t.frecuencia;
            tarifa.meses = t.meses;
            tarifa.personas = t.personas;
            tarifa.sesiones = t.sesiones;
            tarifa.precio = t.precio;
            tabService.querySelector('.tarifa-svc-pick h6').textContent = t.nombre.trim();
            $.smallBox({color: "#111509",content: '<i class="fa fa-check"></i> <i>Se modific√≥ satisfactoriamente</i>'});
        } else{
            $.smallBox({color: "rgb(204, 77, 77)", content: "<i class='fa fa-fw fa-close'></i><em>Los valores del tarifario ingresado son inv√°lidos</em>" ,timeout: 5000})
        }
    }

    function getTarifa(){
        const tar = new Object();
        tar.nombre = document.querySelector('#NombreTarifario').value.trim();
        tar.frecuencia = document.querySelector('#FrecuenciaPaquete').value.trim();
        tar.personas = document.querySelector('#txtCantidadPersonas').value.trim();
        tar.meses = document.querySelector('#txtCantidadMeses').value.trim();
        tar.sesiones = document.querySelector('#txtCantidadSesiones').value.trim();
        tar.valid = false;

        const jQvalidate = Array.from(document.querySelectorAll('#contentTarifario input')).filter(e=>!$(e).valid()).length == 0 ? true : false;
        if(jQvalidate && tar.nombre !== "" && tar.frecuencia !== "" && Number(tar.personas)>0 && (Number(tar.meses)>0 || Number(tar.sesiones)>0)){
            tar.precio = document.querySelector('#PrecioPaquete').value;
            tar.valid = true;
            tar.id = ++accTarifaId;
        }
        if(tar.nombre === ""){
            document.querySelector('#NombreTarifario').classList.remove('state-success');
            document.querySelector('#NombreTarifario').classList.add('state-error');
        }
        return tar;
    }

    function mostrarMediosPago(mediosPago, cuentas){
        const ccs = mediosPago.split("|");
        ccs.forEach(id=>{
            tabService.querySelector('.cc-elegido[data-id="'+id+'"]').classList.remove('hidden');
        })

        if(cuentas != undefined){
            cuentas = JSON.parse(cuentas);
            ccBancarias = cuentas;
            const mePagos = document.getElementById('MediosPagosAgregados');
            cuentas.forEach(c=>{
                mePagos.appendChild(htmlStringToElement(`<a href="javascript:void(0);" data-id="${c.bancoId}" style="padding-right: 30px"><img class="cc-bancaria" data-id="${c.bancoId}" src="${_ctx}img/bill.png" style="width: 64px;"></a>`));
            });
        }
    }

    function getRedesSociales(){
        let res = {};
        res.nombres = "";
        res.have = false;
        const fb = document.querySelector('#RsFb').value.trim();
        const instagran = document.querySelector('#RsIn').value.trim();
        const youtube = document.querySelector('#RsYo').value.trim();

        if(fb.length > 4){
            res.have = true;
            res.nombres+= "fb:"+fb.trim();
        }

        if(instagran.length > 4){
            res.nombres+= res.have ? "|":"";
            res.have = true;
            res.nombres+= "in:"+instagran.trim();
        }

        if(youtube.length > 4){
            res.nombres+= res.have ? "|":"";
            res.have = true;
            res.nombres+= "yo:"+youtube.trim();
        }
        return res;
    }

    function editarServicio(svcId){
        const svc = servicios.find(s=>s.id===svcId);
        if(svc !== undefined){
            setBasicsServicio(svc);
        }else {
            $.smallBox({color: 'alert', content: '<i class="fa fa-exclamation-circle fa-fw"></i><i>El servicio seleccionado no se ha guardado correctamente</i>'});
        }
    }

    function setBasicsServicio(svc){
        const nombre = document.querySelector('#NombreServicio').value.trim();
        const descripcion = document.querySelector('#DescripcionServicio').value.trim();
        const incluye = getAsStringIncluyeServices();
        const infoAdicional = document.querySelector('#ServicioInfAdic').value.trim();
        const jQvalidate = Array.from(document.querySelector('#SvcCamposBasicos').querySelectorAll('.form-control')).filter(e=>!$(e).valid()).length == 0 ? true : false;
        if(nombre !== "" && descripcion !== "" && incluye !== "" && jQvalidate){
            const isNomRepeat = servicios.filter(e=>e.id!==svc.id).find(e=>e.nombre === nombre);
            if(isNomRepeat){
                $.smallBox({color: "rgb(204, 77, 77)", content: "<i class='fa fa-fw fa-close'></i><em>Nombre del servicio esta repetido, modificarlo</em>" ,timeout: 3500})
                return;
            }
            svc.nombre = nombre;
            svc.descripcion = descripcion;
            svc.incluye = incluye;
            svc.infoAdicional = infoAdicional;
            service.querySelector('.servicio.svc-focus').textContent = svc.nombre;
            $.smallBox({color: "#111509",content: '<i class="fa fa-check"></i> <i>Se modific√≥ satisfactoriamente</i>'});
        }else{
            $.smallBox({
                color: 'alert',
                content: '<i class="fa fa-exclamation-circle fa-fw"></i><i>Los nuevos datos que edit√≥ del servicio son inv√°lidos, verif√≠quelos y corr√≠jalos</i>'
            });
            if(!svc.nombre){
                document.querySelector('#NombreServicio').classList.remove('state-sucess');
                document.querySelector('#NombreServicio').classList.add('state-error');
            }
            if(!svc.descripcion){
                document.querySelector('#DescripcionServicio').classList.remove('state-sucess');
                document.querySelector('#DescripcionServicio').classList.add('state-error');
            }
            if(!document.querySelector('#PrimerIncluyeServicio').value.trim()){
                document.querySelector('#PrimerIncluyeServicio').classList.remove('state-sucess');
                document.querySelector('#PrimerIncluyeServicio').classList.add('state-error');
            }
        }
    }

    function getAsStringIncluyeServices(){
        return Array.from(document.querySelectorAll('#MainIncluyeServicios textarea')).map(v=>v.value  !==  "" ? v.value : "").filter(v=>v.trim()!=="").join('|');
    }

    function generateBodyToUpdate(){
        const obj = getFormData($('#frm_registro'));

        obj.idiomas = getValuesConcatInpCheckbox('Idiomas');
        obj.estudios = getValuesByClass('inp-estudio');
        obj.experiencias = getValuesByClass('inp-experiencia');
        obj.resultados = getValuesByClass('inp-resultado');
        obj.formasTrabajo = getValuesConcatInpCheckbox('FormaTrabajo');
        obj.niveles = getValuesConcatInpCheckbox('NivelClientes');
        obj.especialidades = getValuesByClass('inp-esp-domino');
        let redes = getRedesSociales();
        if(redes.have){
            obj.redes = redes.nombres;
        }
        obj.nota = document.getElementById('Nota').value;
        obj.servicios = servicios;
        obj.mediosPago = $perfil.mediosPago;
        obj.sexo = $perfil.tipoTrainerId == TipoTrainer.PARTICULAR ||
                    $perfil.tipoTrainerId == TipoTrainer.DE_EMPRESA
                    ? document.querySelector('input[name="Sexo"]:checked').value : 3;
        let finalExtension = "";
        let finalImagenRecortada = document.getElementById('FinalImagenRecortada');
        if(finalImagenRecortada.src.startsWith("https")){
            finalExtension = $perfil.nomImgPerfil.substring($perfil.nomImgPerfil.lastIndexOf("."));
        }else{
            finalExtension = inpImgPerfil.files[0].name.substring(inpImgPerfil.files[0].name.lastIndexOf("."));
        }
        obj.imgExt = finalExtension;
        if(!obj.horario){
            delete obj['horario'];
        }
        if(!obj.nota){
            delete obj.nota;
        }
        return obj;
    }

    function elegirOtraImagenCropper(){
        cropper.destroy();
        cropper = {};
        inpImgPerfil.click();
    }

    function getServiciosAsync(trainerId){
        $.ajax({
            type: 'GET',
            url: _ctx + 'p/trainer/get/servicios/' + trainerId +'?tipoTrainerId='+TipoTrainer.PARTICULAR,
            dataType: 'json',
            blockLoading: false,
            noOne: true,
            success: function (res) {
                empTrainerId = res.empresaTrainerId;
                res = res.servicios;
                res.forEach(e => {
                    if(e.tarifarios) {
                        e.tarifarios = JSON.parse(e.tarifarios);
                    }
                })
                serviciosSm = JSON.parse(JSON.stringify(res));
                servicios = res;
                if(servicios.length>0){
                    reconstruirServicios(servicios);
                    reconstruirTarifario(servicios[0].tarifarios);
                    tabService.querySelector('.servicio').click();
                    $('#Tarifarios .tarifa-svc')[0].click();
                }

            }, error: (xhr) => {
                if (xhr.status == 404) {
                    window.location.href = _ctx + "p/recurso-no-encontrado";
                }
                exception(xhr);
            }, complete: () => {
            }
        })
    }

    function constraintsValidation() {
        $(frm).validate({
            errorClass: errorClass,
            errorElement: errorElement,
            highlight: function (element) {
                if(element.type === 'radio' || element.type==='checkbox'){
                    let msgError = "";
                    setTimeout(() => {
                        const eleMsgError = document.querySelector(`#${element.name}-error`);
                        if(eleMsgError != undefined){
                            msgError = eleMsgError.textContent;
                            eleMsgError.remove();
                        }
                    }, 100);
                    const parentRadios = element.parentElement.parentElement.parentElement.parentElement;
                    setTimeout(() => {parentRadios.querySelector('em') != undefined ? parentRadios.querySelector('em').textContent = msgError : parentRadios.append(htmlStringToElement(`<em style="color: #E54C4B;">${msgError}</em>`))}, 200);
                }else{
                    $(element).removeClass('state-success').addClass("state-error");
                    $(element).removeClass('valid');
                }
            },
            unhighlight: function (element) {
                if(element.type === 'radio' || element.type==='checkbox'){
                    const parentRadios = element.parentElement.parentElement.parentElement.parentElement;
                    parentRadios.querySelector('em') != undefined ? parentRadios.querySelector('em').remove() : '';
                } else {
                    $(element).removeClass("state-error").addClass('state-success');
                    $(element).addClass('valid');
                }
            },
            ignore: ".ignore",
            rules: {
                Sexo:{
                    required: true
                },
                Especialidad:{
                    required: true,
                    rangelength: [5, 80]
                },
                DisciplinaId:{
                    required: true
                },
                Acerca:{
                    required: true,
                    rangelength: [80, 2000]
                },
                Idiomas:{
                    required: true
                },
                EstudiosCertificaciones:{
                    required: true,
                    rangelength: [8, 90]
                },
                MetodoTrabajo:{
                    required: true,
                    rangelength: [5, 1000]
                },
                Experiencias: {
                    required: true,
                    rangelength: [20, 90]
                },
                Resultados: {
                    required: true,
                    rangelength: [20, 90]
                },
                Horario: {
                    rangelength: [8, 150]
                },
                NivelClientes:{
                    required: true
                },
                CentroTrabajo: {
                    rangelength: [10, 90]
                },
                EspecDomino: {
                    required: true,
                    rangelength: [10, 80]
                },
                FormaTrabajo:{
                    required: true
                },
                RsFb:{
                    url: true,
                    rangelength: [10,150],
                },
                RsIn:{
                    url: true,
                    rangelength: [10,150],
                },
                RsYo:{
                    url: true,
                    rangelength: [10,150],
                },
                NombreServicio:{
                    lettersonly: true,
                    rangelength: [2, 50],
                },
                PrimerIncluyeServicio:{
                    rangelength: [8, 10*50]
                },
                DescripcionServicio:{
                    rangelength: [80, 2000]
                },
                ServicioInfAdic:{
                    rangelength: [20, 1000]
                },
                NombreTarifario:{
                    rangelength: [2, 30],
                    lettersonly: true
                },
                txtCantidadPersonas:{
                    number: true,
                    min: 1
                },
                txtCantidadMeses:{
                    number: true,
                    min: 1
                },
                txtCantidadSesiones:{
                    number: true,
                    min: 1
                },
                PrecioPaquete:{
                    number: true,
                    rangelength: [1, 8],
                    min: 1
                },
                Nota: {
                    rangelength: [10, 400]
                }
            },
            messages: {
                Username: {
                    pattern: "Solo se admiten letras m√≠nusculas y n√∫meros, adem√°s el nombre debe empezar con 3 letras"
                },
                NombreServicio:{
                    pattern: "Solo se admiten letras y n√∫meros"
                },
                PrecioPaquete:{
                    number: function(){
                        setTimeout(() => {
                            $('#IcoPrecioPaquete').tooltip();
                        }, 200);
                        return '<i class="fa fa-fw fa-exclamation-circle" id="IcoPrecioPaquete" title="Solo se permiten n√∫meros con punto como separador decimal"></i>';
                    },
                    min: function(){
                        setTimeout(() => {
                            $('#IcoPrecioPaquete').tooltip();
                        }, 200);
                        return '<i class="fa fa-fw fa-exclamation-circle" id="IcoPrecioPaquete" title="El valor debe ser mayor a 0"></i>';
                    },
                },
                txtCantidadPersonas:{
                    min: function(){
                        setTimeout(() => {
                            $('#IcoTxtCantidadPersonas').tooltip();
                        }, 200);
                        return '<i class="fa fa-fw fa-exclamation-circle" id="IcoTxtCantidadPersonas" title="Debe especificar un valor mayor a 0" style="color: #c46a69"></i>';
                    }
                },
                txtCantidadMeses:{
                    min: function(){
                        setTimeout(() => {
                            $('#IcoTxtCantidadMeses').tooltip();
                        }, 200);
                        return '<i class="fa fa-fw fa-exclamation-circle" id="IcoTxtCantidadMeses" title="Debe especificar un valor mayor a 0" style="color: #c46a69"></i>';
                    }
                },
                txtCantidadSesiones:{
                    min: function(){
                        setTimeout(() => {
                            $('#IcoTxtCantidadSesiones').tooltip();
                        }, 200);
                        return '<i class="fa fa-fw fa-exclamation-circle" id="IcoTxtCantidadSesiones" title="Debe especificar un valor mayor a 0" style="color: #c46a69"></i>';
                    }
                },
                NumeroCuentaSoles:{
                    pattern: "Solo se permiten n√∫meros y como separadores espacio y gui√≥n",
                },
                InterbancarioSoles:{
                    pattern: "Solo se permiten n√∫meros y como separadores espacio y gui√≥n",
                },
            }
        });

        const rules = $(frm).validate().settings.rules;
        Object.keys(rules).filter(e=>rules[e].hasOwnProperty('rangelength')).forEach(e=>{
            document.getElementById(e).setAttribute('maxlength', rules[e].rangelength[1]);
        });
    }
</script>
</body>
</html>
